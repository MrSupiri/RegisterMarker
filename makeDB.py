##==============================================================================
##	██████████████████████████████████████████████████████████████████
##	█░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█
##	█░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█
##	█░░░░█████████░█████░░████░██████████░█████░██████████░░█████░░░░█
##	█░░░███░░░░░░░░░███░░░░██░░░███░░░░███░███░░░███░░░░███░░███░░░░░█
##	█░░░░█████████░░███░░░░██░░░█████████░░███░░░█████████░░░███░░░░░█
##	█░░░░░░░░░░░███░███░░░░██░░░███░░░░░░░░███░░░███░░███░░░░███░░░░░█
##	█░░░██████████░░░███████░░░█████░░░░░░█████░█████░░████░█████░░░░█
##	█░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█
##	█░fb.com/isalapi | github.com/mrsupiri | linkedin.com/in/supiri░░█
##	█░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░█
##	██████████████████████████████████████████████████████████████████
##==============================================================================


from data.database import database
import os

def toDB():
    os.remove('data/database.db')
    with open('data/PrizeWinners.csv', 'r') as f:
        data = f.readlines()[1:]
    db = database()
    db.c.execute('CREATE TABLE IF NOT EXISTS "PrizeWinners" ( `ID` INTEGER PRIMARY KEY AUTOINCREMENT, `PrizeID` INTEGER, `Name` TEXT, `Absent` NUMERIC, `Prizes` TEXT, `Extra` TEXT )')

    for d in data:
        d = d.split(',')
        if d[0].isnumeric():
            print(d)
            db.write('INSERT INTO PrizeWinners(PrizeID, Name, Prizes, Extra) VALUES(?,?,?,?)', d[0], d[1], d[3], d[4][:-2])
            
    db.close()


toDB()
